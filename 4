#Se carga el archivo CSV "feb_23_es_simple.csv" en un dataframe llamado "df" usando la función read_csv() de Pandas.
df=pd.read_csv("/Users/Lidia/PycharmProjects/pythonProject2/EXCEL/feb_23_es_simple.csv", sep='\t')

#La función shape devuelve una tupla con el número de filas y columnas de un dataframe.
# Aquí, se almacenan los valores en las variables "rows" y "cols".
rows = df.shape[0]
cols = df.shape[1]

#Se imprime por pantalla una lista con los nombres de las columnas del dataframe "df".
print ('Las categorias de las columnas son:') #para ver las categorias de las columnas
for col in df.columns:
    print (col)

#Se crea un nuevo dataframe "df1" a partir de "df", incluyendo solo las columnas "captured_at" y "viewer_count".
df1 = df[['captured_at','viewer_count']]

print(df1)


#Se crea una lista "unique_list" con los valores únicos de la columna "captured_at" del dataframe "df".
# Luego se imprime esta lista.
unique_list = list(df['captured_at'].unique())
print(unique_list)



#1.¿Cuál ha sido la evolución de espectadores (captura a captura) durante el periodo?
#Se agrupa el dataframe "df" por la columna "captured_at" y
# se suman los valores de la columna "viewer_count" para cada grupo.
# El resultado se almacena en el dataframe "df_sum" y se imprime.

df_sum = df.groupby(['captured_at'])['viewer_count'].sum().reset_index()

print(df_sum)




#Se carga el archivo CSV "feb_23_es_simple.csv" en un dataframe llamado "df"
# utilizando la opción "chunksize" para leer el archivo en bloques de 10000 filas.
# Se agrupa cada bloque por la columna "captured_at" y
# se suman los valores de la columna "viewer_count" para cada grupo.
# Luego, se agrega cada resultado a la lista "list".
# Al final, se concatena la lista de dataframes "list" en un solo dataframe llamado "final_frame_1".
# Se vuelve a agrupar este dataframe por la columna "captured_at" y
# se suman los valores de la columna "viewer_count" para cada grupo.
# El resultado final se almacena en el dataframe "final_frame_2" y
# se guarda como un archivo CSV llamado "test_2.csv".
list = []
df=pd.read_csv("/Users/Lidia/PycharmProjects/pythonProject2/EXCEL/feb_23_es_simple.csv", chunksize=10000, sep='\t', usecols=["captured_at","viewer_count"])

for chunk in df:
    df2 = df.groupby(['captured_at'])['viewer_count'].sum().reset_index()
    list.append(df2)
    print (chunk)

final_frame_1 = pd.contact(list)
final_frame_2 = final_frame_1.groupby("captured_at")["viewer_count"]reset_index()
final_frame_2.to_csv("test_2.csv")






# Se agrupa el dataframe 'df' por el valor de la columna 'game_name' y
# çluego se calcula la suma de los valores de la columna 'viewer_count' dentro de cada grupo.
# El resultado se almacena en un nuevo dataframe llamado 'df2_sum'.
df2_sum = df.groupby(['game_name'])['viewer_count'].sum().reset_index()

print(df2_sum)
